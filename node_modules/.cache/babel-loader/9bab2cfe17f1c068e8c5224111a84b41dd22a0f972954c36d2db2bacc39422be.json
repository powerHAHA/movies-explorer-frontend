{"ast":null,"code":"import _slicedToArray from\"/Users/denis/dev/movies-explorer-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import'./Movies.css';import{SearchForm}from'../SearchForm/SearchForm';import{MoviesCardList}from'../MoviesCardList/MoviesCardList';import{moviesApi}from'../../utils/MoviesApi';import{filterSearchMovies,filterMoviesDuration}from'../../utils/filtration';import{Preloader}from'../Preloader/Preloader';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Movies=function Movies(_ref){var savedMovies=_ref.savedMovies,onLikeMovie=_ref.onLikeMovie,onDeleteMovie=_ref.onDeleteMovie;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),movies=_useState2[0],setMovies=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),serverErrorMessage=_useState6[0],setServerErrorMessage=_useState6[1];function getAllMovies(movieName,shortFilms){setIsLoading(true);var allMovies=JSON.parse(localStorage.getItem('allMovies'));if(!allMovies){return moviesApi.getAllMovies().then(function(movies){localStorage.setItem('allMovies',JSON.stringify(movies));filterMovies(movieName,shortFilms);}).catch(function(){setServerErrorMessage('Во время запроса произошла ошибка. Возможно, проблема с соединением или сервер недоступен. Подождите немного и попробуйте ещё раз');}).finally(function(){setServerErrorMessage('');});}else{filterMovies(movieName,shortFilms);}}var filterMovies=function filterMovies(movieName,shortFilms){var allMovies=JSON.parse(localStorage.getItem('allMovies'));var filteredMovies=filterSearchMovies(allMovies,movieName);localStorage.setItem('filteredMovies',JSON.stringify(filteredMovies));filterDuration(shortFilms);};function filterDuration(shortFilms){var filteredMovies=JSON.parse(localStorage.getItem('filteredMovies'))||[];var resultMovies=shortFilms?filterMoviesDuration(filteredMovies):filteredMovies;setMovies(resultMovies);setIsLoading(false);}return/*#__PURE__*/_jsxs(\"div\",{className:\"movies\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-container\",children:/*#__PURE__*/_jsx(SearchForm,{onSearch:getAllMovies,filterCheckbox:filterDuration,onError:serverErrorMessage})}),isLoading?/*#__PURE__*/_jsx(Preloader,{}):/*#__PURE__*/_jsx(MoviesCardList,{movies:movies,savedMovies:savedMovies,onLikeMovie:onLikeMovie,onDeleteMovie:onDeleteMovie})]});};","map":{"version":3,"names":["React","useState","SearchForm","MoviesCardList","moviesApi","filterSearchMovies","filterMoviesDuration","Preloader","jsx","_jsx","jsxs","_jsxs","Movies","_ref","savedMovies","onLikeMovie","onDeleteMovie","_useState","_useState2","_slicedToArray","movies","setMovies","_useState3","_useState4","isLoading","setIsLoading","_useState5","_useState6","serverErrorMessage","setServerErrorMessage","getAllMovies","movieName","shortFilms","allMovies","JSON","parse","localStorage","getItem","then","setItem","stringify","filterMovies","catch","finally","filteredMovies","filterDuration","resultMovies","className","children","onSearch","filterCheckbox","onError"],"sources":["/Users/denis/dev/movies-explorer-frontend/src/components/Movies/Movies.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport './Movies.css';\nimport { SearchForm } from '../SearchForm/SearchForm';\nimport { MoviesCardList } from '../MoviesCardList/MoviesCardList';\nimport { moviesApi } from '../../utils/MoviesApi';\nimport { filterSearchMovies, filterMoviesDuration } from '../../utils/filtration';\nimport { Preloader } from '../Preloader/Preloader';\n\nexport const Movies = ({ savedMovies, onLikeMovie, onDeleteMovie }) => {\n\tconst [movies, setMovies] = useState([]);\n\tconst [isLoading, setIsLoading] = useState(false);\n\tconst [serverErrorMessage, setServerErrorMessage] = useState('');\n\n\tfunction getAllMovies(movieName, shortFilms) {\n\t\tsetIsLoading(true);\n\t\tconst allMovies = JSON.parse(localStorage.getItem('allMovies'));\n\t\tif (!allMovies) {\n\t\t\treturn moviesApi\n\t\t\t\t.getAllMovies()\n\t\t\t\t.then((movies) => {\n\t\t\t\t\tlocalStorage.setItem('allMovies', JSON.stringify(movies));\n\t\t\t\t\tfilterMovies(movieName, shortFilms);\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tsetServerErrorMessage('Во время запроса произошла ошибка. Возможно, проблема с соединением или сервер недоступен. Подождите немного и попробуйте ещё раз')\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tsetServerErrorMessage('');\n\t\t\t\t})\n\t\t}\n\t\telse {\n\t\t\tfilterMovies(movieName, shortFilms);\n\t\t}\n\t}\n\tconst filterMovies = (movieName, shortFilms) => {\n\t\tconst allMovies = JSON.parse(localStorage.getItem('allMovies'));\n\n\t\tlet filteredMovies = filterSearchMovies(allMovies, movieName);\n\t\tlocalStorage.setItem('filteredMovies', JSON.stringify(filteredMovies));\n\t\tfilterDuration(shortFilms);\n\t};\n\n\tfunction filterDuration(shortFilms) {\n\t\tconst filteredMovies = JSON.parse(localStorage.getItem('filteredMovies')) || [];\n\n\t\tconst resultMovies = shortFilms\n\t\t\t? filterMoviesDuration(filteredMovies)\n\t\t\t: filteredMovies;\n\n\t\tsetMovies(resultMovies)\n\t\tsetIsLoading(false);\n\t}\n\n\n\treturn (\n\t\t<div className=\"movies\">\n\t\t\t<div className='form-container'>\n\t\t\t\t<SearchForm\n\t\t\t\t\tonSearch={getAllMovies}\n\t\t\t\t\tfilterCheckbox={filterDuration}\n\t\t\t\t\tonError={serverErrorMessage}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{isLoading\n\t\t\t\t? <Preloader />\n\t\t\t\t: <MoviesCardList\n\t\t\t\t\tmovies={movies}\n\t\t\t\t\tsavedMovies={savedMovies}\n\t\t\t\t\tonLikeMovie={onLikeMovie}\n\t\t\t\t\tonDeleteMovie={onDeleteMovie}\n\t\t\t\t/>\n\t\t\t}\n\t\t</div>\n\t);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}